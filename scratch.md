TODO:

- [x] Think about fuzzy matching for reduce / entity resolution
- [x] Support equijoins
- [x] Inputs should be accessed as input['title'] instead of just title / everything be jinja
- [x] Make flatten a separate operator with flatten_key (or nothing)
- [x] Convert parallel flatmap to parallel map
- [x] Write documentation & restructure codebase
- [x] Write tests
- [x] Chunking/splitting with peripheral chunks
- [x] Write build phase
- [ ] Optimize maps
  - [ ] Track costs for the optimizer
  - [ ] Don't use an LLM to determine the right chunk size; try binary search
  - [ ] Call llm agent multiple times on different random inputs & average results
  - [ ] Generate multiple plans and evaluate them instead of generating one plan
  - [ ] Allow splitting to be based on a regex, not just tokens
  - [ ] Have a more principled way of determining peripheral chunks? Right now we've hardcoded values
- [ ] Optimize reduce
  - [ ] Auto-generate resolver
- [ ] Optimize equijoins
- [ ] Operator reordering
- [ ] Support passing expectations
- [ ] Write intermediates to disk
- [ ] Support order by
- [ ] Track traces
