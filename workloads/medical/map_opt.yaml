datasets:
  transcripts:
    path: /Users/shreyashankar/Documents/hacking/motion-v3/workloads/medical/raw_with_id.json
    type: file
default_model: gpt-4o-mini
operations:
  extract_medical_info:
    gleaning:
      num_rounds: 1
      validation_prompt: "Review the output generated by the `extract_medical_info`\
        \ operation and answer the following questions:\n\n1. Completeness: Are all\
        \ medications mentioned in the transcript included in the `medications` list?\
        \ Are all dosages and symptoms mentioned in the transcript present in their\
        \ respective lists?\n2. Accuracy: Is each piece of extracted information correctly\
        \ identified? Are there any errors or misinterpretations in the entries for\
        \ medications, dosages, or symptoms?\n3. Consistency: Is the output format\
        \ precisely following the specified JSON structure? Are there any deviations\
        \ or inconsistencies in how the information is presented?\n4. Attention to\
        \ Detail: Can the output be improved by examining the input more carefully,\
        \ such as catching any subtle mentions of symptoms, dosages, or medications\
        \ that might have been overlooked?\n5. Comprehensive Extraction: Are there\
        \ extraneous or irrelevant details included in the output that do not pertain\
        \ to medications, dosages, or symptoms? \n\nProvide specific examples from\
        \ the transcript and the output for each point above to support your evaluation."
    output:
      schema:
        dosages: list[str]
        medications: list[str]
        symptoms: list[str]
    prompt: "Analyze the following transcript of a conversation between a doctor and\
      \ a patient:\n\n{{ input.src }}\n\nExtract and list all medications, dosages,\
      \ and symptoms mentioned in the transcript.\nIf a piece of information is not\
      \ found, return an empty list for that category.\n\nProvide your response in\
      \ the following JSON format:\n{\n  \"medications\": [\"medication1\", \"medication2\"\
      , ...],\n  \"dosages\": [\"dosage1\", \"dosage2\", ...],\n  \"symptoms\": [\"\
      symptom1\", \"symptom2\", ...]\n}\n"
    type: map
pipeline:
  output:
    path: extracted_medical_info.json
    type: file
  steps:
  - input: transcripts
    name: medical_info_extraction
    operations:
    - extract_medical_info
